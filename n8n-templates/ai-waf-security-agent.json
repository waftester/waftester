{
  "name": "Test WAF security interactively with AI agent and WAFtester MCP",
  "description": "## What it does\n\nA conversational AI agent that connects to [WAFtester](https://waftester.com) via MCP (Model Context Protocol) for interactive Web Application Firewall security testing. Type natural language requests — the agent picks the right tools, runs the tests, and explains the results.\n\n## About WAFtester\n\n[WAFtester](https://waftester.com) is an open-source CLI for testing Web Application Firewalls. It ships 27 MCP tools, 2,800+ attack payloads across 18 categories (SQLi, XSS, SSRF, SSTI, command injection, XXE, and more), detection signatures for 26 WAF vendors and 9 CDNs, and enterprise-grade assessment with F1/MCC scoring and letter grades (A+ through F).\n\n- GitHub: [github.com/waftester/waftester](https://github.com/waftester/waftester)\n- Docs: [Installation](https://github.com/waftester/waftester/blob/main/docs/INSTALLATION.md) | [Examples](https://github.com/waftester/waftester/blob/main/docs/EXAMPLES.md) | [Commands](https://github.com/waftester/waftester/blob/main/docs/COMMANDS.md)\n\n## Who it's for\n\n- **Security engineers** running ad-hoc WAF assessments\n- **Penetration testers** who want AI-assisted reconnaissance and bypass discovery\n- **DevSecOps teams** validating WAF coverage before and after deployments\n- **API security teams** testing OpenAPI/Swagger specs against WAF rules\n\n## How it works\n\nThe workflow has four nodes:\n\n1. **Chat Trigger** — Opens an n8n chat interface where you type requests in plain English\n2. **AI Agent** — Receives your message, reasons about which tools to call, and orchestrates the testing workflow\n3. **OpenAI Chat Model** — Provides the LLM reasoning layer (GPT-4o recommended; swappable for Anthropic, Ollama, etc.)\n4. **WAFtester MCP** — Connects to the WAFtester server via SSE and exposes all 27 tools to the agent\n\nThe agent follows a standard WAF testing workflow:\n\n1. **detect_waf** — Fingerprint the WAF vendor and CDN protecting the target\n2. **discover** — Map the attack surface (endpoints, parameters, technologies) from robots.txt, sitemaps, JavaScript, and Wayback Machine\n3. **learn** — Generate a prioritized test plan based on discovery results\n4. **scan** — Fire 2,800+ attack payloads and measure detection vs. bypass rates\n5. **bypass** — Systematic mutation matrix testing to find WAF evasion techniques\n6. **assess** — Generate a formal security grade with F1, precision, MCC, and false positive rate\n\nLong-running operations (scan, assess, bypass, discover, discover_bypasses, event_crawl, scan_spec) run asynchronously — the agent polls for results automatically.\n\n## Key capabilities\n\n| Capability | Details |\n|---|---|\n| WAF detection | Fingerprint 26 WAF vendors and 9 CDNs from response headers, cookies, and error pages |\n| Payload scanning | 2,800+ payloads across 18 attack categories |\n| Bypass discovery | Mutation matrix with 40+ tamper techniques to find WAF evasions |\n| Enterprise assessment | F1 score, precision, MCC, false positive rate, and A+ through F grading |\n| API spec testing | Validate, plan, and scan OpenAPI/Swagger/Postman specs |\n| Headless crawling | Click-driven DOM crawling via headless browser for JS-rendered endpoints |\n| Knowledge resources | 12 built-in resources covering WAF signatures, evasion techniques, OWASP mappings, and config defaults |\n\n## Example prompts\n\n- \"What WAF is protecting https://example.com?\"\n- \"Scan https://example.com for SQLi and XSS\"\n- \"Find WAF bypasses for https://example.com\"\n- \"Run a full security assessment of https://example.com\"\n- \"Validate my API spec at https://example.com/openapi.json\"\n- \"Discover the attack surface of https://example.com\"\n\n## How to set up\n\n1. **Start WAFtester MCP server:**\n   `docker run -p 8080:8080 ghcr.io/waftester/waftester:latest mcp --http :8080`\n2. **Add OpenAI credentials** in n8n: Settings → Credentials → New → OpenAI API\n3. **Select the credential** in the OpenAI Chat Model node\n4. **Activate** the workflow and open the chat interface\n\nAlternatively, use the included `docker-compose.yml` to run both n8n and WAFtester together with `docker compose up -d`.\n\n## Requirements\n\n| Requirement | Details |\n|---|---|\n| WAFtester MCP server | Docker image (`ghcr.io/waftester/waftester:latest`) or [binary install](https://github.com/waftester/waftester/blob/main/docs/INSTALLATION.md) for macOS, Linux, Windows |\n| LLM API key | OpenAI (default), or swap the model node for Anthropic, Ollama, Azure OpenAI, or any LangChain-compatible provider |\n| Authorization | Only test targets you have explicit written permission to test |\n\n## Links\n\n- [WAFtester website](https://waftester.com)\n- [GitHub repository](https://github.com/waftester/waftester)\n- [Installation guide](https://github.com/waftester/waftester/blob/main/docs/INSTALLATION.md)\n- [Full examples](https://github.com/waftester/waftester/blob/main/docs/EXAMPLES.md)\n- [Docker Hub](https://hub.docker.com/r/waftester/waftester)",
  "nodes": [
    {
      "parameters": {},
      "id": "f22a0b1c-3c36-4ca0-87b7-a2eb1b08ed91",
      "name": "Chat Trigger",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [-192, 288],
      "notes": "Opens the n8n chat interface. Type your security testing requests here."
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "You are a WAF security testing assistant powered by WAFtester. You help users test their Web Application Firewalls by running scans, detecting WAF vendors, discovering attack surfaces, finding bypasses, and generating security assessments.\n\nYour typical workflow:\n1. detect_waf - Identify the WAF vendor protecting the target\n2. discover - Map the attack surface (endpoints, parameters, technologies)\n3. learn - Generate a targeted test plan based on discovery\n4. scan - Fire attack payloads and measure detection rate\n5. bypass - Find WAF evasion techniques using the mutation matrix\n6. assess - Generate a formal WAF grade with F1/MCC metrics\n\nAlways start with detect_waf when given a new target. Be explicit about what each tool does and what the results mean. When scans find bypasses, explain the security impact clearly.\n\nAsync tools (scan, assess, bypass, discover, discover_bypasses, event_crawl) return a task_id. Use get_task_status to poll for results.\n\nAvailable attack categories: sqli, xss, traversal, auth, ssrf, ssti, cmdi, xxe, nosqli, graphql, cors, crlf, redirect, upload, jwt, oauth, prototype, deserialize."
        }
      },
      "id": "fe0e963b-e2f8-44ef-9047-a658abe23a49",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [48, 288],
      "notes": "Routes chat messages to WAFtester tools. The system prompt guides the agent through the standard testing workflow."
    },
    {
      "parameters": {
        "sseEndpoint": "={{ $env.WAFTESTER_SSE_URL || 'http://waftester:8080/sse' }}"
      },
      "id": "87146f4d-a2ba-4cfc-98ac-5e83612fbde1",
      "name": "WAFtester MCP",
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [192, 496],
      "notes": "Connects to WAFtester MCP server via SSE. All 27 WAFtester tools are auto-discovered."
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "4d2d9f26-1870-4ea1-82b6-1b45d070d0f1",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [48, 496],
      "notes": "Configure your OpenAI API credentials here. GPT-4o recommended for best results.",
      "credentials": {
        "openAiApi": {
          "id": "credential-id",
          "name": "OpenAI account"
        }
      }
    },
    {
      "parameters": {
        "width": 640,
        "height": 780,
        "content": "### How it works\n\nChat with an AI agent that has access to WAFtester's 27 security testing tools via MCP (Model Context Protocol).\n\n**Chat Trigger** receives your message, **AI Agent** decides which tools to call, **WAFtester MCP** executes the tests and returns results.\n\nThe agent follows a standard testing workflow:\n1. **detect_waf** — Fingerprint the WAF vendor (26 WAFs, 9 CDNs)\n2. **discover** — Map endpoints from robots/sitemap/JS/Wayback\n3. **learn** — Generate a prioritized test plan\n4. **scan** — Fire 2,800+ payloads across 18 attack categories\n5. **bypass** — Mutation matrix testing for WAF evasions\n6. **assess** — Enterprise grading with F1/MCC metrics (A+ through F)\n\nAsync operations (scan, assess, bypass, discover, discover_bypasses, event_crawl, scan_spec) return a task_id and the agent polls automatically.\n\n### Setup steps\n\n1. Start WAFtester MCP server:\n```\ndocker run -p 8080:8080 ghcr.io/waftester/waftester:latest mcp --http :8080\n```\n2. Add OpenAI credentials: **Settings → Credentials → New → OpenAI API**\n3. Click the OpenAI Chat Model node and select your credential\n4. If WAFtester runs on a different host, set `WAFTESTER_SSE_URL` env variable\n5. Activate the workflow and open the chat interface\n\n### Example prompts\n\n- \"Scan https://example.com for SQLi and XSS\"\n- \"What WAF is protecting https://example.com?\"\n- \"Find WAF bypasses for https://example.com\"\n- \"Assess the WAF effectiveness of https://example.com\"\n- \"Validate my OpenAPI spec at https://example.com/openapi.json\"\n- Customize the system prompt in the AI Agent node for your workflow"
      },
      "id": "60117f92-b6c4-4de6-a8d8-3304545f5725",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-960, 0]
    },
    {
      "parameters": {
        "width": 720,
        "height": 144,
        "content": "## AI Agent chain\n\nChat Trigger sends messages to the AI Agent, which calls WAFtester MCP tools with OpenAI as the reasoning layer."
      },
      "id": "236b3768-06a3-4b28-8968-bf1fea98c548",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-288, 0]
    }
  ],
  "connections": {
    "Chat Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WAFtester MCP": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "meta": {
    "templateCredsSetupCompleted": false
  },
  "tags": []
}
