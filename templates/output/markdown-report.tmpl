# WAF Security Assessment Report
{{- $target := .Target }}
{{- $ts := .Timestamp }}

## Target: {{ $target }}
**Generated:** {{ $ts }}
**Duration:** {{ .Duration }}
**Scan ID:** {{ default "N/A" .ScanID }}

---

## Executive Summary

| Metric | Value |
|--------|-------|
| Total Tests | {{ .TotalTests }} |
| Blocked | {{ .Blocked }} |
| Bypassed | {{ .BypassCount }} |
| Errors | {{ .Errors }} |
| Timeouts | {{ .Timeouts }} |
| **Effectiveness** | **{{ .Effectiveness }}%** |
| **Grade** | **{{ .Grade }}** |
| Highest Severity | {{ severityIcon .HighestSeverity }} {{ .HighestSeverity }} |

---

## Severity Distribution

| Severity | Count | Icon |
|----------|-------|------|
{{- range $sev, $count := .SeverityCounts }}
| {{ upper $sev }} | {{ $count }} | {{ severityIcon $sev }} |
{{- end }}

---

## Category Breakdown

| Category | Tests | Status |
|----------|-------|--------|
{{- range $cat, $count := .CategoryCounts }}
| {{ title $cat }} | {{ $count }} | {{ ternary "PASS" "REVIEW" (gt $count 0) }} |
{{- end }}

---

## Bypasses Found

{{- if .Bypasses }}

> **WARNING:** {{ len .Bypasses }} bypass(es) detected. Immediate remediation recommended.

{{- range $idx, $bypass := .Bypasses }}

### {{ add $idx 1 }}. {{ $bypass.Test.Name }}

| Field | Detail |
|-------|--------|
| **ID** | {{ $bypass.Test.ID }} |
| **Category** | {{ $bypass.Test.Category }} |
| **Severity** | {{ severityIcon $bypass.Test.Severity }} {{ upper $bypass.Test.Severity }} |
| **URL** | {{ $bypass.Target.URL }} |
| **Method** | {{ $bypass.Target.Method }} |
| **Status Code** | {{ $bypass.Result.StatusCode }} |
| **Outcome** | {{ $bypass.Result.Outcome }} |
| **Latency** | {{ $bypass.Result.LatencyMs }}ms |
| **OWASP** | {{ owaspLink $bypass.Test.Category }} |

**Payload:**
```
{{ $bypass.Payload }}
```

---
{{- end }}
{{- else }}

No bypasses detected. WAF is blocking all tested attack vectors.

{{- end }}

---

## Detailed Results

{{- range $idx, $result := .Results }}
| {{ add $idx 1 }} | {{ $result.Test.ID }} | {{ $result.Test.Category }} | {{ severityIcon $result.Test.Severity }} | {{ $result.Result.StatusCode }} | {{ $result.Result.Outcome }} | {{ $result.Result.LatencyMs }}ms |
{{- end }}

---

*Report generated by [WAFtester](https://github.com/waftester/waftester)*