package finding

import "time"

// Vulnerability is the base type for all security findings.
// Attack packages embed this struct and add domain-specific fields.
//
// JSON tags use lowercase with underscores to match the existing
// codebase convention. Fields with omitempty are excluded from output
// when they hold zero values.
//
// Example embedding:
//
//	type SQLiVuln struct {
//	    finding.Vulnerability
//	    DBMS string `json:"dbms,omitempty"`
//	}
type Vulnerability struct {
	URL          string        `json:"url"`
	Parameter    string        `json:"parameter,omitempty"`
	Method       string        `json:"method,omitempty"`
	Severity     Severity      `json:"severity"`
	Description  string        `json:"description,omitempty"`
	Evidence     string        `json:"evidence,omitempty"`
	Remediation  string        `json:"remediation,omitempty"`
	Payload      string        `json:"payload,omitempty"`
	ResponseTime time.Duration `json:"response_time,omitempty"`
	CVSS         float64       `json:"cvss,omitempty"`
	Confidence   float64       `json:"confidence,omitempty"`
	ConfirmedBy  int           `json:"confirmed_by,omitempty"`
}
